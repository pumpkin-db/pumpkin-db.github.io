<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>视觉SLAM学习笔记：六 | Pumpkin's Blogs</title><meta name="author" content="pumpkin-db"><meta name="copyright" content="pumpkin-db"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第七章、第八章视觉里程计(VO-Visual Odometry)特征点法特征点：由关键点和描述子组成关键点选角点（像素灰度变化明显的地方），描述子：描述了周围像素的信息，按照“外观相似的特征应该有相似的描述子”设计的 ORB(Oriented FAST and Rotated BRIEF)特征ORB的关键点是Oriented FAST描述子是Rotated BRIEF FAST特征点仅仅比较像素之">
<meta property="og:type" content="article">
<meta property="og:title" content="视觉SLAM学习笔记：六">
<meta property="og:url" content="https://pumpkin-db.github.io/2026/02/13/Visual_SLAM/10_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E5%85%AD/index.html">
<meta property="og:site_name" content="Pumpkin&#39;s Blogs">
<meta property="og:description" content="第七章、第八章视觉里程计(VO-Visual Odometry)特征点法特征点：由关键点和描述子组成关键点选角点（像素灰度变化明显的地方），描述子：描述了周围像素的信息，按照“外观相似的特征应该有相似的描述子”设计的 ORB(Oriented FAST and Rotated BRIEF)特征ORB的关键点是Oriented FAST描述子是Rotated BRIEF FAST特征点仅仅比较像素之">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pumpkin-db.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2026-02-12T16:00:00.000Z">
<meta property="article:modified_time" content="2026-02-12T17:12:54.000Z">
<meta property="article:author" content="pumpkin-db">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="SLAM">
<meta property="article:tag" content="cpp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pumpkin-db.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "视觉SLAM学习笔记：六",
  "url": "https://pumpkin-db.github.io/2026/02/13/Visual_SLAM/10_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E5%85%AD/",
  "image": "https://pumpkin-db.github.io/img/butterfly-icon.png",
  "datePublished": "2026-02-12T16:00:00.000Z",
  "dateModified": "2026-02-12T17:12:54.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "pumpkin-db",
      "url": "https://pumpkin-db.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://pumpkin-db.github.io/2026/02/13/Visual_SLAM/10_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E5%85%AD/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '视觉SLAM学习笔记：六',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">10</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> home</span></a></div><div class="menus_item"><a class="site-page" href="/archives"><span> archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories"><span> categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags"><span> tags</span></a></div><div class="menus_item"><a class="site-page" href="/about"><span> about</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Pumpkin's Blogs</span></a><a class="nav-page-title" href="/"><span class="site-name">视觉SLAM学习笔记：六</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> home</span></a></div><div class="menus_item"><a class="site-page" href="/archives"><span> archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories"><span> categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags"><span> tags</span></a></div><div class="menus_item"><a class="site-page" href="/about"><span> about</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">视觉SLAM学习笔记：六</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2026-02-12T16:00:00.000Z" title="Created 2026-02-13 00:00:00">2026-02-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-02-12T17:12:54.000Z" title="Updated 2026-02-13 01:12:54">2026-02-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%A7%86%E8%A7%89SLAM/">视觉SLAM</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="第七章、第八章"><a href="#第七章、第八章" class="headerlink" title="第七章、第八章"></a>第七章、第八章</h1><h2 id="视觉里程计-VO-Visual-Odometry"><a href="#视觉里程计-VO-Visual-Odometry" class="headerlink" title="视觉里程计(VO-Visual Odometry)"></a>视觉里程计(VO-Visual Odometry)</h2><h3 id="特征点法"><a href="#特征点法" class="headerlink" title="特征点法"></a>特征点法</h3><p><strong>特征点：由关键点和描述子组成</strong><br>关键点选角点（像素灰度变化明显的地方），<br>描述子：描述了周围像素的信息，按照“外观相似的特征应该有相似的描述子”设计的</p>
<h4 id="ORB-Oriented-FAST-and-Rotated-BRIEF-特征"><a href="#ORB-Oriented-FAST-and-Rotated-BRIEF-特征" class="headerlink" title="ORB(Oriented FAST and Rotated BRIEF)特征"></a>ORB(Oriented FAST and Rotated BRIEF)特征</h4><p>ORB的关键点是Oriented FAST<br>描述子是Rotated BRIEF</p>
<p>FAST特征点仅仅比较像素之间亮度的差异<br>ORB添加了尺度和旋转的描述，尺度不变性依靠构建<strong>图像金字塔</strong>，并在金字塔的每一层上检测角点实现的，特征的旋转是通过**灰度质心法(Intensity Centroid)**实现的</p>
<p><strong>图像金字塔</strong><br>金字塔是指通过对图像进行不同层次的降采样，以获得不同分辨率的图像<br><img src="/./images/Visual_SLAM/ch7&ch8/%E9%87%91%E5%AD%97%E5%A1%94.png"><br><strong>灰度质心法(Intensity Centroid)</strong><br>在一小块图像B中，定义图像块的矩为：$$m_{pq}=\sum_{x,y \in B} x^p y^q I(x,y),\;\;\;\;\;\;\;p,q=\{0,1\}$$<br>通过矩可以找到图像块的质心：$$C=\left(\frac{m_{{10}}}{m_{00}}, \frac{m_{01}}{m_{00}}\right)$$<br>连接图像块的几何中心$O(x_{0},y_{0})$与质心$C$，得到一个方向向量$\overrightarrow{OC}$，定义特征点的方向为：$$\theta=\arctan\left(\frac{\frac{m_{01}}{m_{00}}-y_{0}}{\frac{m_{10}}{m_{00}}-x_{0}}\right)$$<br>特别地，对于$O$在原点的情况，有：$$\theta=\arctan\left(\frac{m_{01}}{m_{10}}\right)$$<br><strong>BRIEF描述子</strong><br>BRIEF描述子是一种二进制描述子，描述向量由多个0和1组成，这里的0和1编码了关键点附近的两个随机像素（比如p和q）的大小关系：如果p比q大，则取1，反之则取0。<br>原始的BRIEF描述子不具有旋转不变性，因此在图像发生旋转时容易丢失。而OEB在FAST特征点提取阶段计算了关键点的方向，所以可以利用方向信息，计算旋转后的”Steer BRIEF”特征使ORB的描述子具有较好的旋转不变性。</p>
<h4 id="特征匹配"><a href="#特征匹配" class="headerlink" title="特征匹配"></a>特征匹配</h4><p><img src="/./images/Visual_SLAM/ch7&ch8/%E7%89%B9%E5%BE%81%E5%8C%B9%E9%85%8D.png"></p>
<p><img src="/./images/Visual_SLAM/ch7&ch8/%E8%AE%A1%E7%AE%97%E7%9B%B8%E6%9C%BA%E8%BF%90%E5%8A%A8.png"></p>
<h4 id="2D-2D：对极几何"><a href="#2D-2D：对极几何" class="headerlink" title="2D-2D：对极几何"></a>2D-2D：对极几何</h4><h5 id="基本模型"><a href="#基本模型" class="headerlink" title="基本模型"></a>基本模型</h5><p>首选看基本的模型示意图：<br><img src="/./images/Visual_SLAM/ch7&ch8/%E5%AF%B9%E6%9E%81%E5%87%A0%E4%BD%95%E7%BA%A6%E6%9D%9F.png"><br>在推导对极约束之前，先定义一些基本的量：<br><img src="/./images/Visual_SLAM/ch7&ch8/%E5%AF%B9%E6%9E%81%E5%87%A0%E4%BD%95%E5%9F%BA%E6%9C%AC%E9%87%8F.png"></p>
<p><img src="/./images/Visual_SLAM/ch7&ch8/%E5%B0%BA%E5%BA%A6%E6%84%8F%E4%B9%89%E4%B8%8B%E7%9B%B8%E7%AD%89.png"></p>
$$sp \simeq p$$
<p>（虽然感觉这样做对下面的推导没有什么帮助，唯一就是看起来简洁了一点点，但是实际上给$x_{1},x_{2}$换个定义就解决了，或者直接带着写也不麻烦。但是，不理解，但尊重，所以这里还是这样写了）<br>还有就是第一个式子不带变换矩阵应该也是为了简洁，因为只有两张图像，所以干脆P的坐标就是在相机1下的空间坐标</p>
<p>上述两个投影关系可以写为：$$p_{1} \simeq KP \;\;\;\;\;\;\;\; p_{2} \simeq K(RP+t)$$<br>然后取：$$x_{1}=K^{-1}p_{1} \simeq P,\;\;\;\;\;\;\;\; x_{2}=K^{-1}p_{2} \simeq RP+t$$<br>故：$$x_{2} \simeq Rx_{1}+t$$<br>同时左乘$t^{\wedge}$：$$t^{\wedge} x_{2} \simeq t^{\wedge} Rx_{1}$$<br>再同时左乘$x_{2}^{T}$：$$x_{2}^{T} t^{\wedge} x_{2} \simeq x_{2}^{T} t^{\wedge} Rx_{1}$$<br>观察左侧，$t^{\wedge} x_{2}$与$t$和$x_{2}$都垂直，故左侧等于0，那右侧也等于0，即：$$x_{2}^{T} t^{\wedge} Rx_{1}=0$$<br>再把$p_{1} ,p_{2}$带入可得：$$p_{2}^{T} K^{-T} t^{\wedge} R K^{-1} p_{1} = 0$$<br>把这两个式子都称为对极约束，几何意义是$O_{1},P,O_{2}$三者共面。<br>对极约束中同时包含了平移和旋转。把中间部分记作两个矩阵：<strong>基础矩阵(Fundamental Matrix)F和本质矩阵(Essential Matrix)E</strong>，即：$$E=t^{\wedge} R \;\;\;\;\;\;\;\;F=K^{-T}EK^{-1}$$<br>进一步简化对极约束得到：$$x_{2}^{T} E x_{1}=p_{2}^{T}Fp_{1}=0$$<br>“对极约束简洁地给出了两个匹配点的空间位置关系。于是，相机位姿估计问题变为以下两步”：</p>
<ul>
<li><ol>
<li>根据配对点的像素位置求出$E$或者$F$</li>
</ol>
</li>
<li><ol start="2">
<li>根据$E$或者$F$求出$R,t$</li>
</ol>
</li>
</ul>
$E$和$F$之间只差了相机内参，相机内参在SLAM中通常是已知的，所以实践中往往使用形式更简单的
<h5 id="本质矩阵"><a href="#本质矩阵" class="headerlink" title="本质矩阵"></a>本质矩阵</h5><p><img src="/./images/Visual_SLAM/ch7&ch8/%E6%9C%AC%E8%B4%A8%E7%9F%A9%E9%98%B5%E5%89%8D%E8%BF%B0.png"><br>设两个坐标：$$x_{1}=[u_{1},v_{1},1]^{T},x_{2}=[u_{2},v_{2},1]^{T}$$<br>根据对极约束，有：$$\left(\begin{matrix}
u_{2} & v_{2} & 1
\end{matrix}\right) \left(\begin{matrix}
e_{1} & e_{2} & e_{3} \\ e_{4} & e_{5} & e_{6} \\ e_{7} & e_{8} & e_{9}
\end{matrix}\right) \left(\begin{matrix}
u_{1} \\ v_{1} \\ 1
\end{matrix} \right)=0$$<br>我们希望变为$Ax=0$的形式，那样会好写很多，所以有下面的变换：$$\mathbf{e}=[e_{1},e_{2},e_{3},e_{4},e_{5},e_{6},e_{7},e_{8},e_{9}]^{T}$$<br>可以写作$$[u_{2}u_{1},u_{2}v_{1},u_{2},v_{2}u_{1},v_{2}u_{1},v_{2},u_{1},v_{1},1]\cdot \mathbf{e}=0$$<br>带入8个点的结果就是：<img src="/./images/Visual_SLAM/ch7&ch8/%E5%85%AB%E7%82%B9%E6%B3%95.png"><br>这样就把本质矩阵$E$求出来了，现在要恢复出相机的运动$R,t$，使用奇异值分解(SVD)得到，设$E$的$S V D$为：$$E=U \Sigma V^{T}$$<br>其中$U,V$为正交阵，$\Sigma$为奇异值矩阵。根据E的内在性质，知道$\Sigma = diag(\sigma,\sigma,0)$<br>在$SVD$分解中，对于任意一个$E$，存在两个可能的$t,R$与它对应：$$t_{1}^{\wedge}=U R_{Z} \left( \frac{\pi}{2} \right) \Sigma U^{T},\;\;\;\;\;R_{1}=UR_{Z}^{T} \left( \frac{\pi}{2} \right) V^{T}$$</p>
$$t_{2}^{\wedge}=U R_{Z} \left( -\frac{\pi}{2} \right) \Sigma U^{T},\;\;\;\;\;R_{2}=UR_{Z}^{T} \left(- \frac{\pi}{2} \right) V^{T}$$
<p>其中，$R_{Z}\left( \frac{\pi}{2} \right)$表示沿Z轴旋转$90^{\circ}$得到的矩阵。<br>由于$-E$与$E$等价，所以对任意一个$t$取负号，也会得到同样的结果。<br>因此从$E$分解到$t,R$时，一共存在4个可能的解。<br><img src="/./images/Visual_SLAM/ch7&ch8/4%E7%A7%8D%E8%A7%A3.png"><br><img src="/./images/Visual_SLAM/ch7&ch8/%E6%9C%AC%E8%B4%A8%E7%9F%A9%E9%98%B5%E5%A4%84%E7%90%86.png"><br>这里对于奇异值的处理不理解，不过先接受。</p>
<h5 id="单应矩阵"><a href="#单应矩阵" class="headerlink" title="单应矩阵"></a>单应矩阵</h5><p>另一种常见的矩阵是单应矩阵(Homography)$\mathbf{H}$<br>它描述了两个平面之间的映射关系，若场景种的特征点都落在同一平面上（比如墙、地面等），则可以通过单应性进行运动估计。</p>
<p>单应矩阵通常描述处于共同平面上的一些点在两张图像之间的变换关系。设图像$I_{1}$和$I_{2}$有一对匹配好的特征点$p_{1}$和$p_{2}$。这个特征点落在平面$P$上，设这个平面满足方程：$$n^{T}P+d=0$$<br>其中$n$是平面的法向量，$d$是一个常数，整理得到：$$-\frac{n^{T}P}{d}=1$$<br>根据$p_{2} \simeq K(RP+t)$，得到：<img src="/./images/Visual_SLAM/ch7&ch8/%E5%8D%95%E5%BA%94%E7%9F%A9%E9%98%B5%E6%8E%A8%E5%AF%BC.png"><br>记作：$$p_{2} \simeq \mathbf{H} p_{1}$$<br>展开得到：$$\left(\begin{matrix}
u_{2} \\ v_{2} \\ 1
\end{matrix}\right) \simeq \left(\begin{matrix}
h_{1} & h_{2} & h_{3} \\ h_{4} & h_{5} & h_{6} \\ h_{7} & h_{8} & h_{9}  
\end{matrix}\right) \left(\begin{matrix}
u_{1} \\ v_{1} \\ 1
\end{matrix} \right)$$<br>我们显式写为：$$s \left(\begin{matrix}
u_{2} \\ v_{2} \\ 1
\end{matrix}\right) = \left(\begin{matrix}
h_{1} & h_{2} & h_{3} \\ h_{4} & h_{5} & h_{6} \\ h_{7} & h_{8} & h_{9}  
\end{matrix}\right) \left(\begin{matrix}
u_{1} \\ v_{1} \\ 1
\end{matrix} \right)$$<br>得到三个式子：</p>
<ul>
<li>$su_{2}=h_{1}u_{1}+h_{2}v_{1}+h_{3}$</li>
<li>$sv_{2}=h_{4}u_{1}+h_{5}v_{1}+h_{6}$</li>
<li>$s=h_{7}u_{1}+h_{8}v_{1}+h_{9}$
用第三个式子消去第一个式子，得到：</li>
<li>$u_{2}=\frac{h_{4}u_{1}+h_{5}v_{1}+h_{6}}{h_{7}u_{1}+h_{8}v_{1}+h_{9}}$</li>
<li>$v_{2}=\frac{h_{4}u_{1}+h_{5}v_{1}+h_{6}}{h_{7}u_{1}+h_{8}v_{1}+h_{9}}$
实际中，若$h_{9} \neq 0$，则令$h_{9}=1$，整理得到：</li>
<li>$h_{1}u_{1}+h_{2}v_{1}+h_{3}-h_{7}u_{1}u_{2}-h_{8}v_{1}u_{2}=u_{2}$</li>
<li>$h_{4}u_{1}+h_{5}v_{1}+h_{6}-h_{7}u_{1}v_{2}-h_{8}v_{1}v_{2}=v_{2}$
这个$\simeq$，或者说这个系数$s$可以任意变化（非零），所以这个$3 \times 3$的矩阵是$9-1=8$个自由度。也可以通过刚才令$h_{9}=1$得出，只有8个未知量了。<br>一组匹配点可以构成两个约束，所以只要4对匹配点，就能把$\mathbf{H}$算出来了</li>
</ul>
<p>同样把$\mathbf{H}$的求解写为向量形式，这个类似$Ax=b$<br><img src="/./images/Visual_SLAM/ch7&ch8/%E5%8D%95%E5%BA%94%E7%9F%A9%E9%98%B5%E5%90%91%E9%87%8F%E5%BD%A2%E5%BC%8F%E6%B1%82%E8%A7%A3.png"><br><img src="/./images/Visual_SLAM/ch7&ch8/%E5%8D%95%E5%BA%94%E7%9F%A9%E9%98%B5%E6%80%BB%E7%BB%93.png"></p>
<h5 id="对极几何的三种讨论"><a href="#对极几何的三种讨论" class="headerlink" title="对极几何的三种讨论"></a>对极几何的三种讨论</h5><h6 id="尺度不确定性："><a href="#尺度不确定性：" class="headerlink" title="尺度不确定性："></a>尺度不确定性：</h6><p>简言之，在单目SLAM中，对轨迹和地图同时缩放任意倍数，得到的图像依然是一样的。</p>
<p>在单目视觉中，对两张图像的$t$的归一化相当于固定了尺度，虽然不知道实际的长度是多少，但我们以这时的$t$为单位1，计算相机运动和特征点的3D位置，这被称为单目SLAM的初始化。</p>
<p>在初始化后，就可以用3D-2D计算相机运动了，初始化后的轨迹和地图的单位，就是初始化时固定的尺度，因此，单目SLAM有一步不可避免的初始化。初始化的两张图像必须有一定程度的平移，而后的轨迹和地图都将以此不的平移为单位。<br>初始化的两种方法：</p>
<ul>
<li><ol>
<li>对$t$进行归一化</li>
</ol>
</li>
<li><ol start="2">
<li>令初始化时所以的特征点的平均深度为1，<br>相比于令$t$长度为1的做法，特征点深度归一化可以控制场景的规模大小，使计算在数值上更稳定。</li>
</ol>
</li>
</ul>
<h6 id="初始化的纯旋转问题"><a href="#初始化的纯旋转问题" class="headerlink" title="初始化的纯旋转问题"></a>初始化的纯旋转问题</h6><p>结论：单目初始化不能只有纯旋转，必须要有一定程度的平移。如果没有平移，单目将无法初始化。</p>
<h6 id="多余八对点的情况"><a href="#多余八对点的情况" class="headerlink" title="多余八对点的情况"></a>多余八对点的情况</h6><p>八点法中，解的是适定方程，如果多余八对点，就是一个超定方程。<br>方法是最小二乘误差。<br>刚才的八点法式子写为：$$A\mathbf{e}=0$$<br>最小化一个二次型来求解：$$\underset{e}{min} \|A\mathbf{e}\|^{2}_{2}=\underset{e}{min} \;\mathbf{e}^{T}A^{T} A \mathbf{e}$$<br>于是就得到了在最小二乘意义下的$E$矩阵。<br>不过，当可能存在误匹配的情况时，我们会更倾向于使用<strong>随机采样一致性(Random Sample Concensus, RANSAC)</strong> 来求，而不是最小二乘。<br>RANSAC是一种通用的做法，适用于很多带错误数据的情况，可以处理带有错误匹配的数据。</p>
<h5 id="三角测量"><a href="#三角测量" class="headerlink" title="三角测量"></a>三角测量</h5><p>刚刚使用对极几何约束估计了相机运动，在得到运动之后，需要用相机的运动估计特征点的空间位置。<br>在单目SLAM中，仅通过单张图像无法获得像素的深度信息，我们需要通过<strong>三角测量（Triangulation）</strong> 的方法估计地图点的深度。<br><img src="/./images/Visual_SLAM/ch7&ch8/%E4%B8%89%E5%AE%B6%E6%B5%8B%E9%87%8F%E6%B3%95.png"><br>按照对极几何中的定义，设$x_{1},x_{2}$为两个特征点的归一化坐标，满足：$$s_{2} x_{2} = s_{1} R x_{1} + t$$<br>现在已知$R,t$，想求解两个特征点的深度$s_{1},s_{2}$。从几何上看，可以在射线$O_{1} p_{1}$上寻找3D点，使其投影位置接近$p_{2}$。或者在$O_{2}p_{2}$上找，或者在两条线的中间找，都可以。<br>例如，希望计算$s_{1}$，那么先对上式两侧左乘一个$x^{\wedge}_{2}$，得：$$s_{2} x_{2}^{\wedge} x_{2} =0= s_{1} x_{2}^{\wedge} R x_{1} + x_{2}^{\wedge} t$$<br>右侧就是关于$s_{1}$的方程，求得$s_{1}$后，$s_{2}$也可以直接求得。<br>于是就得到了两帧下的点的深度，确定了它们的空间坐标。<br>当然，由于噪声的存在，所估得的$R,t$不一定精确使上式为0，所以更常见的做法是求最小而成解而不是直接的解。</p>
<p>三角测量是通过平移得到的，有平移才有对极几何中的三角形.<br>当平移很小的时候，像素上的不确定性将导致较大的深度不确定性。<br>如果特征点运动一个像素$\delta x$，使得视线角变化了一个角度$\delta \theta$，那么将测量到深度值有$\delta d$的变化。当$t$较大时，$\delta d$将明显变小，说明平移较大时，在同样的相机分辨率下，三角化测量将更精确。<br>如下图所示：<br><img src="/./images/Visual_SLAM/ch7&ch8/%E4%B8%89%E8%A7%92%E6%B5%8B%E9%87%8F%E6%B3%A8%E6%84%8F%E7%82%B9.png"><br>提高三角化的精度有两种方法，一种是提高特征点的精度，也就是提高图像的分辨率，但是导致图像变大，增加计算成本。另一种方式是使平移量增大，但是，这会导致图像的外观发生明显的变化，但是外观变化会使得特征提取于匹配变得困难。<br>简言之，就是增大平移可能导致匹配失效；而平移太小，则三角化精度不够——这就是三角化的矛盾，把这个问题称为“视差”（parallax）</p>
<h4 id="3D-2D：PnP-Perspective-n-Point-透视n点"><a href="#3D-2D：PnP-Perspective-n-Point-透视n点" class="headerlink" title="3D-2D：PnP(Perspective-n-Point 透视n点)"></a>3D-2D：PnP(Perspective-n-Point 透视n点)</h4><p>PnP是求解3D点对2D点运动的方法<br>PnP问题有很多求解方法：例如，用3对点估计位姿的P3P、直接线性变换(DLT)、EPnP(Efficient PnP)、UPnP，等等。还可以使用非线性优化的方式，构建最小二乘问题并迭代求解，也就是BA，光束法平差（Bundle Adjustment）</p>
<h5 id="直接线性变换-DLT"><a href="#直接线性变换-DLT" class="headerlink" title="直接线性变换(DLT)"></a>直接线性变换(DLT)</h5><p>考虑某个空间点P，其次坐标为$P=(X,Y,Z,1)^{T}$，投影到特征点$x_{1}=(u_{1},v_{1},1)^{T}$（以归一化平面齐次坐标表示）。此时，相机的位姿是未知的。<br>与单应矩阵的求解类似，定义增广矩阵$[R|t]$为一个$3 \times 4$矩阵，包含了旋转与平移信息（与变换矩阵$T$不同），展开如下：$$s \left(\begin{matrix}
u_{1} \\ v_{1} \\ 1
\end{matrix}\right) = \left(\begin{matrix}
t_{1} & t_{2} & t_{3} & t_{4} \\ t_{5} & t_{6} & t_{7} & t_{8} \\ t_{9}
& t_{10} & t_{11} & t_{12}  \end{matrix} \right) \left( \begin{matrix}
X \\ Y \\ Z \\ 1
\end{matrix} \right)$$<br>和之前的处理类似，用最后一行把$s$消去，得到两个约束：$$u_{1}=\frac{t_{1}X+t_{2}Y+t_{3}Z+t_{4}}{t_{9}X+t_{10}Y+t_{11}Z+t_{12}}\;\;\;\;\;\;\;\;\; v_{1}=\frac{t_{5}X+t_{6}Y+t_{7}Z+t_{8}}{t_{9}X+t_{10}Y+t_{11}Z+t_{12}}$$<br>为简化表示，定义$T$的行向量：$$t_{1}=(t_{1},t_{2},t_{3},t_{4})^{T},t_{2}=(t_{5},t_{6},t_{7},t_{8})^{T},t_{3}=(t_{9},t_{10},t_{11},t_{12})^{T}$$<br>把上面的式子可以重新写为：$$t_{1}^{T}P-t_{3}^{T}Pu_{1}=0$$</p>
$$t_{2}^{T}P-t_{3}^{T}Pv_{1}=0$$
<p>一对匹配点提供两个关于$t$的线性约束，假设有$N$个特征点，可以得到：$$\left( \begin{matrix}
P_{1}^{T} & 0 & -u_{1}P_{1}^{T} \\ 0 & P_{1}^{T} & -v_{1}P_{1}^{T} \\  \vdots & \vdots & \vdots \\ P_{N}^{T} & 0 & -u_{N}P_{N}^{T} \\ 0 & P_{N}^{T} & -v_{N}P_{N}^{T}
\end{matrix} \right) \left( \begin{matrix}
t_{1} \\ t_{2} \\ t_{3}
\end{matrix}\right) =0$$</p>
$t$一共有12维，因此最少通过6对匹配点即可实现矩阵$T$的线性求解，这种方法称为$DLT$，当匹配点大于6对时，也可以使用SVD等方法对超定方程求最小二乘解。

<p>这里求解出了12个参数，假设是认为左边是$R$，右边是$t$，右边好说，就是一个三维向量，但是左边的$R$，要求是正交的，但是求出来的不一定是正交的，所以对于$R$，需要对左边$3 \times 3$的矩阵块进行一个近似，寻找一个最好的旋转矩阵对它进行近似，可以由QR分解完成，也可以像这样来计算：$$R \leftarrow (R R^{T})^{-\frac{1}{2}}R$$<br>这相当于把结果从矩阵空间重新投影到SE(3)流形上，转换成旋转和平移两部分。<br>补充：<strong>流形是一个“局部看起来像欧几里得空间，但整体可能弯曲或有复杂拓扑结构”的几何对象。</strong><br>或者使用SVD分解：$$R=U \Sigma V^{T}$$<br>然后令$R_{new}=UV^{T}$即可</p>
<h5 id="P3P"><a href="#P3P" class="headerlink" title="P3P"></a>P3P</h5><p>P3P仅使用3对匹配点，对数据要求较少<br>示意图如下：<img src="/./images/Visual_SLAM/ch7&ch8/P3P%E9%97%AE%E9%A2%98%E7%A4%BA%E6%84%8F%E5%9B%BE.png"><br>由于已知$a,b,c$三点在归一化平面的坐标，所以$\cos<a,b> ,\cos<b,c>,\cos<a,c>$都知道，对三角形使用余弦定理得到：<img src="/./images/Visual_SLAM/ch7&ch8/%E4%BD%99%E5%BC%A6%E5%AE%9A%E7%90%861.png"><br>同除$OC^2$，记$x=\frac{OA}{OC},y=\frac{OB}{OC}$，得到：<img src="/./images/Visual_SLAM/ch7&ch8/%E4%BD%99%E5%BC%A6%E5%AE%9A%E7%90%862.png"><br>记$v=\frac{AB^2}{OC^2},uv=\frac{BC^2}{OC^2},wv=\frac{AC^2}{OC^2}$，有：<img src="/./images/Visual_SLAM/ch7&ch8/%E4%BD%99%E5%BC%A6%E5%AE%9A%E7%90%863.png"><br>把第一个式子的$v$带入到后两个式子，整理为：$$(1-u)y^2-ux^2-\cos<b,c>y+2uxy\cos<a,b>+1=0$$</p>
$$(1-w)x^2-wy^2-\cos<a,c>x+2wxy\cos<a,b>+1=0$$

$u$和$v$可以通过$A,B,C$在世界坐标系的坐标算出，变换到相机坐标系后，比值不变。
<p>式子中$x,y$是未知的，求解这个方程需要用到吴消元法。<br>类似于分解$E$的情况，该方程最多可能得到4个解，可以用验证点（记为$D-d$）计算最可能的解，得到$A,B,C$在相机坐标系下的3D坐标。然后根据3D-3D的点对，计算相机的运动$R,t$</p>
<p>P3P的问题：</p>
<ul>
<li><ol>
<li>P3P只利用3个点的信息，当给定的配对点多于3组，难以利用更多的信息</li>
</ol>
</li>
<li><ol start="2">
<li>如果3D点或2D点受噪声影响，或者存在误匹配，则算法失效</li>
</ol>
</li>
</ul>
<h5 id="最小化重投影误差"><a href="#最小化重投影误差" class="headerlink" title="最小化重投影误差"></a>最小化重投影误差</h5><p><strong>把相机和三维点放在一起进行最小化的问题，统称为Bundle Adjustment</strong></p>
<p>考虑$n$个三维空间点$P$及其投影$p$，我们希望计算相机的位姿$R,t$，李群表示为</p>
$T$。假设某空间点坐标为$P_{i}=[X_{i},Y_{i},Z_{i}]^{T}$，其投影的像素坐标为$u_{i}=[u_{i},v_{i}]^{T}$，可以写为：$$s_{i}u_{i}=KTP_{i}$$
<p>现在定义误差：$$e_{i}=u_{i}-\frac{1}{s_{i}}KTP_{i}$$<br>构建最小二乘问题，目的是求解最好的相机位姿，使得误差平方和最小化：$$T=arg  \, \underset{T}{min} \frac{1}{2} \sum_{i=1}^{n} \| e_{i} \|^{2}_{2}$$<br>该问题的误差项，是将3D点的投影位置与观测位置作差，所以称为<strong>重投影误差</strong><br>使用非齐次坐标$u_{i}=[u_{i},v_{i}]^{T}$，误差就只有两维了。</p>
<p>现在已经成为最小二乘问题了，使用高斯牛顿法或者列文伯格——马夸尔特方法，现在只需要知道每个误差项关于优化变量的导数$J^{T}$：$$e(x+\Delta x)\approx e(x)+J^{T} \Delta x$$<br>记变换到相机坐标系下的空间坐标为$P'$，并将其前3维取出来：$$P'=(TP)_{1:3}=[X',Y',Z']^{T}$$<br>得到：$$su=KP'$$<br>展开：$$\left[ \begin{matrix}
su \\ sv \\s
\end{matrix} \right]=\left[ \begin{matrix}
f_{x} & 0 & c_{x} \\ 0 & f_{y} & c_{y} \\ 0 & 0 & 1
\end{matrix} \right] \left[ \begin{matrix}
X' \\ Y' \\ Z'
\end{matrix} \right] $$<br>同样用第三行消去前两行的$s$，得到：$$u=f_{x} \frac{X'}{Z'}+c_{x}, \;\;\;\; v=f_{y} \frac{Y'}{Z'}+c_{y} $$<br>故误差就可以写成：$$e_{i}=u_{i}-u$$<br>写为矩阵就是：$$e_{i}=\left[ \begin{matrix}
u_{i}-u \\ v_{i}-v
\end{matrix} \right]$$<br>对$T$左乘扰动量$\delta \xi$，考虑$e$的变化关于扰动量的导数，利用链式法则，可以写为下面这个式子：$$\frac{\partial e}{\partial \delta \xi}= {\lim_{ \delta \xi \to 0 } } \frac{e(\delta \xi \oplus \xi) -e(\xi)}{\delta \xi}=\frac{\partial e}{\partial P'} \frac{\partial P'}{\partial \delta \xi}$$<br>利用矩阵求导规则得到：$$\frac{\partial e}{\partial P'}=-\left[ \begin{matrix}
\frac{\partial u}{\partial X'} & \frac{\partial u}{\partial Y'} & \frac{\partial u}{\partial Z'} \\ \frac{\partial u}{\partial X'} & \frac{\partial u}{\partial Y'} & \frac{\partial u}{\partial Z'}
\end{matrix} \right]=-\left[ \begin{matrix}
\frac{f_{x}}{Z'} & 0 & -\frac{f_{x}X'}{Z^{2}} \\ 0 & \frac{f_{y}}{Z'} & -\frac{f_{y}Y'}{Z'^{2}}
\end{matrix} \right]$$<br>根据之前关于李代数导数的推导，知道：$$\frac{\partial (TP)}{\partial \delta \xi}=(TP)^{\odot}=\left[ \begin{matrix}
I & -P'^{\wedge} \\ 0^{T} & 0^{T}
\end{matrix} \right]$$<br>在$P'$的定义中，取出了前三维，于是：$$\frac{\partial P'}{\partial \delta \xi}=\left[\begin{matrix}
I,-P'^{\wedge}
\end{matrix}\right]$$<br>根据链式法则，把两项相乘，得到：$$\frac{\partial e}{\partial \delta \xi}=-\left[ \begin{matrix}
\frac{f_{x}}{Z'} & 0 & -\frac{f_{x}X'}{Z'^{2}} & -\frac{f_{x}X'Y'}{Z'^{2}} & f_{x}+\frac{f_{x}X'^{2}}{Z'^{2}} & -\frac{f_{x}Y'}{Z'} \\0 & \frac{f_{y}}{Z'} & -\frac{f_{y}Y'}{Z'^{2}} & -f_{y}-\frac{f_{y}Y'^{2}}{Z'^{2}} & \frac{f_{y}X'Y'}{Z'^{2}} & \frac{f_{y}X'}{Z'}
\end{matrix} \right]$$<br>除了优化位姿，还希望优化特征点的空间位置，所以，需要讨论$e$关于空间点$P$的导数，仍然使用链式法则：$$\frac{\partial e}{\partial P}=\frac{\partial e}{\partial P'} \frac{\partial P'}{\partial P}$$<br>第一项刚才已经知道了，后一项：$$P'=(TP)_{1:3}=RP+t$$<br>故：$$\frac{\partial P'}{\partial P}=R$$<br>所以：$$\frac{\partial e}{\partial P}= -\left[ \begin{matrix}
\frac{\partial u}{\partial X'} & \frac{\partial u}{\partial Y'} & \frac{\partial u}{\partial Z'} \\ \frac{\partial u}{\partial X'} & \frac{\partial u}{\partial Y'} & \frac{\partial u}{\partial Z'}
\end{matrix} \right] R$$<br>至此，推导出了观测方程关于<strong>相机位姿</strong>与<strong>特征点</strong>的两个导数矩阵，它们能够在优化过程中提供重要的梯度方向，指导优化的迭代</p>
<p><strong>使用g2o进行BA优化</strong><br>这里尊重原版，直接放上来<br><img src="/./images/Visual_SLAM/ch7&ch8/g2oBA%E4%BC%98%E5%8C%96.png"></p>
<h4 id="3D-3D：ICP-Iterative-Cloest-Point-迭代最近点"><a href="#3D-3D：ICP-Iterative-Cloest-Point-迭代最近点" class="headerlink" title="3D-3D：ICP(Iterative Cloest Point 迭代最近点)"></a>3D-3D：ICP(Iterative Cloest Point 迭代最近点)</h4><p>假设有一组配对好的3D点（例如对两幅RGB-D图像进行了匹配）：$$P=\{ p_{1}, \cdots ,p_{n} \},\;\;\;\;P'=\{ p_{1}^{'}, \cdots, p_{n}^{'} \}$$<br>现在，想要找一个欧式变换$R,t$，使得：$$\forall i ,p_{i}=Rp_{i}^{'}+t$$<br>考虑3D-3D之间的变换时，和相机没有关系。<br>下面是两种求解方式：</p>
<ul>
<li>线性代数求解（SVD为主）</li>
<li>非线性优化求解（类似于BA）</li>
</ul>
<h5 id="SVD方法"><a href="#SVD方法" class="headerlink" title="SVD方法"></a>SVD方法</h5><p>定义误差项：$$e_{i}=p_{i}-(Rp_{i}^{'}+t)$$<br>构建最小二乘问题：$$\underset{R,t}{min} \frac{1}{2} \sum^{n}_{i=1} \| e_{i} \|^{2}_{2}$$<br>下面是求解方法的推导。<br>首先定义两组点的质心：$$p=\frac{1}{n} \sum^{n}_{i=1}(p_{i}), \;\;\;\;p'=\frac{1}{n} \sum^{n}_{i=1}(p_{i}')$$<br>然后对误差项进行一加一减：<img src="/./images/Visual_SLAM/ch7&ch8/ICP,SVD%E6%8E%A8%E5%AF%BC.png"><br>其中$p_{i}-p$和$p_{i}'-p'$在求和后就是0，所以最后一项直接消失，目标函数可以简化为：$$\underset{R,t}{min} \, J= \frac{1}{2} \sum^{n}_{i=1} \| p_{i}-p-R(p_{i}' -p') \|^{2} + \| p-Rp'-t \|^{2}$$<br>发现这个式子左侧只和$R$相关，右侧的和$R,t$都有关，而且右侧只和质心相关。<br>所以只要让式子左侧为最小，获得了$R$后，再把$R$带入第二项，令第二项为0就能得到$t$。</p>
<p>所以，ICP可以分为以下三个步骤求解：</p>
<ul>
<li><ol>
<li>计算两组点的质心位置$p,p'$，然后计算每个点的<strong>去质心坐标</strong>：$$q_{i}=p_{i}-p,\;\;\; q_{i}'=p_{i}'-p'$$</li>
</ol>
</li>
<li><ol start="2">
<li>构建以下优化问题计算旋转矩阵：$$R^{*}=arg\,\, \underset{R}{min} \frac{1}{2} \sum^{n}_{i=1} \| q_{i}-Rq_{i}' \|^{2}$$</li>
</ol>
</li>
<li><ol start="3">
<li>根据第二步的$R$计算$t$：$$t^{*}=p-Rp'$$<br>步骤解释完了，发现只要算出了$R$，$t$是非常好求的，所以下面把精力放到计算$R$上面来，把关于$R$的误差项进行展开，得到：$$\frac{1}{2} \sum^{n}_{i=1} \| q_{i}-Rq_{i}' \|^{2}=\frac{1}{2} \sum^{n}_{i=1}(q_{i}^{T}q_{i}+q_{i}'^{T}R^{T}Rq_{i}'-2q_{i}^{T}Rq_{i}')$$<br>发先第一项与$R$无关，且$R^{T}R=I$，所以第二项也与$R$无关。因此，优化目标函数变为：$$\sum^{n}_{i=1}-q_{i}^{T}Rq_{i}'= \sum^{n}_{i=1}- tr(q_{i}^{T}Rq_{i}')= -tr\left( R \sum^{n}_{i=1} q_{i}' q_{i}^{T} \right)$$<br>至于证明通过SVD解出的$R$是最优的，这里略过，这里直接应用方法，先定义矩阵：$$W=\sum^{n}_{i=1}q_{i}q_{i}^{T}$$</li>
</ol>
</li>
</ul>
$W$是一个$3 \times 3$的矩阵，对$W$进行SVD分解，得到：$$W=U \Sigma V^{T}$$
<p>其中，$\Sigma$是奇异值组成的对角矩阵，对角线元素从大到小排列，而$U$和$V$为对角矩阵，当$W$满秩时，$R$为：$$R=UV^{T}$$<br>如果此时$R$的行列式为负，则取$-R$作为最优值。这样就得到了$R$的最优解，然后带入刚才得到的第二项就可以得到$t$了</p>
<p>类似我了，猜这里不会有人看到，不，应该不会有人看，要是有人看到这里，直接v你50，疯狂星期四</p>
<p>其实也可能会被发现，因为在特征点中，这个位置应该叫做边缘，而不是最难匹配的区块</p>
<h5 id="非线性优化方法"><a href="#非线性优化方法" class="headerlink" title="非线性优化方法"></a>非线性优化方法</h5><p>到了非线性优化，一般就是要使用李代数了，现在使用李代数表达位姿，刚才的最小化的式子是：$$\underset{R,t}{min} \frac{1}{2} \sum^{n}_{i=1} \| e_{i} \|^{2}_{2}=\underset{R,t}{min} \frac{1}{2} \sum^{n}_{i=1} \| p_{i}-(Rp_{i}^{'}+t) \|^{2}_{2}= \underset{R,t}{min} \frac{1}{2} \sum^{n}_{i=1} \| p_{i}-Tp_{i}' \|^{2}_{2}$$<br>把变换矩阵变改为李代数的表示，从李代数到李群是指数映射，式子就变为了：$$\underset{R,t}{min} \frac{1}{2} \sum^{n}_{i=1} \| p_{i}-\exp(\xi^{\wedge}) p_{i}' \|^{2}_{2}$$<br>下面的问题就是求导，这里使用左扰动模型，之前的结论是：$$\frac{\partial TP}{\partial \delta \xi}=(TP)^{\odot}=\left[ \begin{matrix}
I & -P^{' \wedge} \\ 0^{T} & 0^{T}
\end{matrix} \right]$$<br>这里的$e$是$p_{i}-Tp_{i}'$，所以求导后有一个负号，结果就是：$$\frac{\partial e}{\partial  \delta \xi }=-(\exp(\xi ^{\wedge})p_{i}')^{\odot}$$<br>这里得到的导数就是高斯牛顿里面的雅可比矩阵$J$：$$J=\frac{\partial e}{\partial  \delta \xi }$$<br>于是，在非线性优化中只需要不断迭代，就能找到极小值。而且，可以证明，ICP问题存在唯一解或无穷多解的情况。在唯一解的情况下，只要能找到极小值解，这个极小值就是全局最优值——因此不会遇到局部最小极小而非全局最小的情况。这也意味着ICP求解可以任意选定初始值，这是已匹配点时求解ICP的一大好处。</p>
<p>这里的ICP是指已由图像特征给定了匹配的情况下进行位姿估计的问题。在匹配已知的情况下，这个最小二成问题实际上具有解析解，所以没有必要进行迭代优化。</p>
<p>在某些场合下，例如在RGB-D SLAM中，一个像素的深度数据可能有，也可能测量不到，所以可以混合着使用PnP和ICP优化：对于深度已知的特征点，建模它们的3D-3D误差；对于深度未知的特征点，则建模3D-2D的重投影误差。于是，可以将所有的误差放在同一个问题中考虑，使得求解更加方便。</p>
<h3 id="直接法"><a href="#直接法" class="headerlink" title="直接法"></a>直接法</h3><h4 id="2D光流"><a href="#2D光流" class="headerlink" title="2D光流"></a>2D光流</h4><p>光流法还不是那么的直接，它保留特征点，但是只保留关键点，不计算描述子</p>
<p>光流是一种描述像素随时间在图像之间运动的方法，随着时间流逝，同一个像素会在图像中运动，而我们希望追踪它的运动过程。其中，计算部分像素运动的称为<strong>稀疏光流</strong>，计算所有像素的称为<strong>稠密光流</strong>。稀疏光流以Lucas-Kanade光流为代表，并可以在SLAM中用于追踪特征点的位置。稠密光流以Hom-Schunck光流为代表。</p>
<p>下面详细介绍稀疏光流Lucas-Kanade，也称LK光流</p>
<h5 id="Lucas-Kanade光流"><a href="#Lucas-Kanade光流" class="headerlink" title="Lucas-Kanade光流"></a>Lucas-Kanade光流</h5><p><img src="/./images/Visual_SLAM/ch7&ch8/LK%E5%85%89%E6%B5%81%E6%B3%95%E7%A4%BA%E6%84%8F%E5%9B%BE.png"><br>在LK光流中，认为来自相机的图像是随时间变化的。图像可以看作时间的导数：$I(t)$<br>那么，在一个$t$时刻，位于$(x,y)$处的像素，它的灰度可以写成：$$I(x,y,t)$$<br>这种方式把图像看成了关于位置与时间的函数，值域就是图像中像素的灰度。</p>
<p>首先引入光流法的基本假设：</p>
<ul>
<li><strong>灰度不变假设</strong>：同一个空间点的灰度像素值，在各个图像中是固定不变的</li>
</ul>
<p>对于$t$时刻位于$(x,y)$处的像素，我们设$t+dt$时刻它运动到$(x+dx,y+dy)$处，根据灰度不变，有：$$I(x+dx,y+dy,t+dt)=I(x,y,t)$$<br>不过需要注意灰度不变假设是一个很强的假设，实际中很可能不成立。<br>但是现在姑且认为假设是成立的，继续向下推导，对左边进行泰勒展开，保留一阶项：$$I(x+dx,y+dy,t+dt) \approx I(x,y,t)+ \frac{\partial I}{\partial x} dx+\frac{\partial I}{\partial y} dy+\frac{\partial I}{\partial t} dt$$<br>根据刚才的假设，得到：$$\frac{\partial I}{\partial x} dx+\frac{\partial I}{\partial y} dy+\frac{\partial I}{\partial t} dt=0$$<br>两侧除以$dt$，得到：$$\frac{\partial I}{\partial x} \frac{dx}{dt}+\frac{\partial I}{\partial y} \frac{dy}{dt}=-\frac{\partial I}{\partial t}$$<br>其中$\frac{dx}{dt}$是像素在$x$轴上的运动速度，而$\frac{dy}{dt}$是像素在$y$轴上的运动速度，把它们记为$u,v$。<br>同时，$\frac{\partial I}{\partial x}$为图像在该点处$x$方向的梯度，$\frac{\partial I}{\partial y}$为图像在该点处$y$方向的梯度，记为$I_{x},I_{y}$。把图像灰度对时间的变化量记为$I_{t}$，写成矩阵形式，有：$$\left[ \begin{matrix}
I_{x} & I_{y}
\end{matrix} \right] \left[ \begin{matrix}
u \\ v
\end{matrix} \right]=-I_{t}$$<br>我们的目标是计算像素的运动$u,v$，仅凭这一个方程是不够的，所以需要引入额外的约束来计算$u,v$。<strong>在LK光流中，假设某一个窗口内的像素具有相同的运动</strong>。<br>考虑一个大小为$w \times w$的窗口，它含有$w^{2}$数量的像素。该窗口内像素具有同样的运动，一次得到$w^2$个方程：$$\left[ \begin{matrix}
I_{x} & I_{y}
\end{matrix} \right]_{k} \left[ \begin{matrix}
u \\ v
\end{matrix} \right]=-I_{tk}, \;\;\;\;\;k=1,\cdots,w^2$$<br>取：$$A=\left[ \begin{matrix}
[I_{x},I_{y}]_{1} \\ \vdots \\ [I_{x}, I_{y}]_{k}
\end{matrix} \right],\;\; b=\left[ \begin{matrix}
I_{t1} \\ \vdots \\ I_{tk}
\end{matrix} \right].$$<br>整个方程变为：$$A \left[ \begin{matrix}
u \\ v
\end{matrix} \right]=-b$$<br>这是一个关于$u,v$的超定线性方程，传统解法是求最小二乘解，书上这里直接给了结论，考虑到我没有学过研究生阶段的矩阵论，所以这里简单推导一下这个解到底是怎么来的。</p>
<p>先把要求的写为$x$，整个式子就是：$$Ax=-b$$<br>想要找到最小二乘解，其实就是：$$\underset{x}{min} \; \|Ax+b\|^{2}_{2}$$<br>方法其实就是求导，记：$$E=(Ax+b)^{T}(Ax+b)$$<br>展开：$$E=x^TA^TAx+x^TA^Tb+b^TAx+b^Tb$$<br>然后对$x^T$求导（根据在非线性优化那章补充的矩阵求导公式）：$$\frac{\partial E}{\partial x^T}=2(x^TA^TA+b^TA)$$<br>令导数等于0，找到极值即为答案，这是因为如果对$E$求二阶导（这里先对列向量$x$求导了）：$$H=\frac{\partial ^2 E}{\partial x \partial x^T}=2A^TA$$<br>这个矩阵$A^TA$的性质是：</p>
<ul>
<li>是对称半正定</li>
<li>如果A是列满秩，那么$A^TA$是正定的<br>在光流法中， A 是由图像梯度$I_{x},I_{y}$构成的矩阵。只要图像区域有足够纹理（即$I_{X},I_{y}$ 不全为零，且不共线），$A^TA$就是正定的。<br>如果$H$正定，那么这个函数是严格的凸函数，只有一个极小值点，所以求导得0就是要找的$x$</li>
</ul>
<p>再回到一阶导数：$$2(X^TA^TA+b^TA)=0$$<br>得到：$$x^{*}=\left[ \begin{matrix}
u \\ v
\end{matrix} \right]^{*}=-(A^TA)^{-1}A^{T}b$$<br>这样就得到了像素在图像间的运动速度$u,v$。<br>当$t$取离散的时刻而不是连续时间时，我们可以估计某块像素在若干个图像中出现的位置。由于像素梯度仅在局部有效，所以如果一次迭代不够好，我们会多迭代几次这个方程。在SLAM中，LK光流常被用来跟踪角点的运动。</p>
<p><strong>多层光流</strong><br>刚才提到，光流需要相机的运动比较小，两张图像的差异不能太大，但是如果就是很大，单层图像光流容易达到一个局部极小值，但是还有补救的措施，就是构建图像金字塔，之前已经提过，就是对图像进行缩放，原始图像作为底层，每往上一层，就对下层图像进行一定倍率的缩放。<br>这个过程也可以叫做<strong>由粗至精(Coarse-to-fine)</strong>，更加形象<br><img src="/./images/Visual_SLAM/ch7&ch8/%E5%9B%BE%E5%83%8F%E9%87%91%E5%AD%97%E5%A1%94%E7%94%B1%E7%B2%97%E8%87%B3%E7%B2%BE.png"><br>效果就是，当原始图像的像素运动较大时，在金字塔顶端的图像看来，运动依然在这一个很小的范围内。</p>
<h4 id="直接法-1"><a href="#直接法-1" class="headerlink" title="直接法"></a>直接法</h4><p>直接开始推导直接法。<br>首先看初始条件：<img src="/./images/Visual_SLAM/ch7&ch8/%E7%9B%B4%E6%8E%A5%E6%B3%95%E6%8E%A8%E5%AF%BC1.png"><br><img src="/./images/Visual_SLAM/ch7&ch8/%E7%9B%B4%E6%8E%A5%E6%B3%95%E6%8E%A8%E5%AF%BC2.png">这里的内容比较简单，直接贴在这里</p>
<p>在直接法中，没有特征匹配这个东西，无从知道哪一个$p_{2}$与$p_{1}$对应着同一个点。</p>
<p>直接法的思路是根据当前相机的位姿估计值寻找$p_{2}$的位置。但若相机的位姿不够好，$p_{2}$的外观和$p_{1}$有明显差别。为了减小这个差别，我们优化相机的位姿(暂且不管初始值是怎么来的)，来寻找与$p_{1}$更相似的$p_{2}$。</p>
<p>这同样可以通过解一个优化问题完成，但是此时优化的不是重投影误差，而是<strong>光度误差</strong>，也就是$P$的两个像素的亮度误差：$$e=I_{1}(p_{1})-I_{2}(p_{2})$$<br>这里的$e$是一个标量。同样优化目标为误差二范数平方，暂时取不加权的形式，为：$$\underset{T}{min}\, J(T)=\| e \|^{2}$$<br>目前依然是依据<strong>灰度不变假设</strong>，假设一个空间点在各个视角下成像的灰度是不变的。<br>同样假设有$N$个空间点$P_{i}$，得到：$$\underset{T}{min}\, J(T)= \sum^{N}_{i=1} e_{i}^{T} e_{i} , \;\;\;\;\;\; e_{i}=I_{1}(p_{1,i})-I_{2}(p_{2,i}) $$<br>然后定义两个中间变量：$$q=TP,\;\;\;\;u=\frac{1}{Z_{2}}Kq$$</p>
$q$是$P$在第二个相机坐标系下的坐标，而$u$为它的像素坐标。下面就是李代数的左扰动模型，利用一阶泰勒展开了：$$e(T)=I_{1}(p_{1})-I_{2}(u)$$
<p>根据链式法则：$$\frac{\partial e}{\partial T}=\frac{\partial I_{2}}{\partial u} \frac{\partial u}{\partial q} \frac{\partial q}{\partial \delta \xi} \delta \xi$$<br>下面的推导之前类似的写过很多次了，下面不想写了，直接贴上来了。<br><img src="/./images/Visual_SLAM/ch7&ch8/%E7%9B%B4%E6%8E%A5%E6%B3%95%E6%8E%A8%E5%AF%BC3.png"><br>相应的直接法也有多层直接法，和光流一样，也是构建一个金字塔。</p>
<p>为了内容的完整性，下面关于直接法的讨论和优缺点分析也贴到这里。<br><img src="/./images/Visual_SLAM/ch7&ch8/%E7%9B%B4%E6%8E%A5%E6%B3%95%E7%9A%84%E8%AE%A8%E8%AE%BA.png"><br><img src="/./images/Visual_SLAM/ch7&ch8/%E7%9B%B4%E6%8E%A5%E6%B3%95%E4%BC%98%E7%BC%BA%E7%82%B91.png"><br><img src="/./images/Visual_SLAM/ch7&ch8/%E7%9B%B4%E6%8E%A5%E6%B3%95%E4%BC%98%E7%BC%BA%E7%82%B92.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://pumpkin-db.github.io">pumpkin-db</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://pumpkin-db.github.io/2026/02/13/Visual_SLAM/10_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E5%85%AD/">https://pumpkin-db.github.io/2026/02/13/Visual_SLAM/10_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E5%85%AD/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/SLAM/">SLAM</a><a class="post-meta__tags" href="/tags/cpp/">cpp</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2026/02/07/Visual_SLAM/09_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E4%BA%94/" title="视觉SLAM学习笔记：五"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">视觉SLAM学习笔记：五</div></div><div class="info-2"><div class="info-item-1">矩阵求导标量函数对向量求导 向量函数对向量求导 常用公式： 线性变换$$\frac{\partial Ax}{\partial x^{T}}=A$$ 恒等变换$$\frac{\partial x}{\partial x^{T}}=I$$ 零矩阵，a为常数向量$$\frac{\partial a}{\partial x^{T}}=0$$ 梯度行向量($a^{T}x$是标量)$$\frac{\partial a^{T}x}{\partial x^{T}}=a^{T}$$ 和$$\frac{\partial x^T a}{\partial x^{T}}=a^{T}$$ 二次型梯度($x^{T}Ax$是标量)$$\frac{\partial x^{T} A x}{\partial x^{T}}=x^{T}(A+A^{T})$$ 链式法则：若$z=f(y),y=g(x)$，则：$$\frac{\partial z}{\partial x^{T}}=\frac{\partial z}{\partial y^{T}}\cdot \frac{\partial y}{\partial x^{T}}...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/02/06/Visual_SLAM/08_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E5%9B%9B/" title="视觉SLAM学习笔记：四"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-06</div><div class="info-item-2">视觉SLAM学习笔记：四</div></div><div class="info-2"><div class="info-item-1">第五章相机模型针孔相机模型  畸变模型 单目相机成像过程 双目相机模型 RGB-D相机模型 习题内参就是个$K$：$$K=\left[\begin{matrix} f_{x} & 0 & c_{x} \\ 0 & f_{y} & c_{y} \\ 0 & 0 & 1 \end{matrix}\right]$$如果相机的分辨率变为原来的两倍，那么$u$和$v$就会变成原来的两倍，由于：$$Z \left[\begin{matrix} u \\ v \\ 1 \end{matrix} \right]= \left[\begin{matrix} f_{x} & 0 & c_{x} \\ 0 & f_{y} & c_{y} \\ 0 & 0 & 1 \end{matrix}\right] \left[\begin{matrix} X \\ Y \\ Z \end{matrix}\right]$$故$$Z \left[\begin{matrix} 2u \\ 2v \\ 1 \end{matrix} \right]= \left[\begin{matrix} 2f_{x} & 0 & 2c...</div></div></div></a><a class="pagination-related" href="/2026/02/07/Visual_SLAM/09_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E4%BA%94/" title="视觉SLAM学习笔记：五"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-07</div><div class="info-item-2">视觉SLAM学习笔记：五</div></div><div class="info-2"><div class="info-item-1">矩阵求导标量函数对向量求导 向量函数对向量求导 常用公式： 线性变换$$\frac{\partial Ax}{\partial x^{T}}=A$$ 恒等变换$$\frac{\partial x}{\partial x^{T}}=I$$ 零矩阵，a为常数向量$$\frac{\partial a}{\partial x^{T}}=0$$ 梯度行向量($a^{T}x$是标量)$$\frac{\partial a^{T}x}{\partial x^{T}}=a^{T}$$ 和$$\frac{\partial x^T a}{\partial x^{T}}=a^{T}$$ 二次型梯度($x^{T}Ax$是标量)$$\frac{\partial x^{T} A x}{\partial x^{T}}=x^{T}(A+A^{T})$$ 链式法则：若$z=f(y),y=g(x)$，则：$$\frac{\partial z}{\partial x^{T}}=\frac{\partial z}{\partial y^{T}}\cdot \frac{\partial y}{\partial x^{T}}...</div></div></div></a><a class="pagination-related" href="/2026/02/02/Visual_SLAM/06_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E4%BA%8C/" title="视觉SLAM学习笔记：二"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-02</div><div class="info-item-2">视觉SLAM学习笔记：二</div></div><div class="info-2"><div class="info-item-1">第三章旋转矩阵，变换矩阵（冗余）这章前面部分都在介绍数学原理 具体内容直接看书，这里说一个有意思的东西： 假设 $$T_{RW}=\left[\begin{matrix}R & t \\ \mathbf{0}^T & {1}\end{matrix}\right] $$  然后 $$T_{WR}=T_{RW}^{-1}=\left[\begin{matrix} R^T & -R^Tt\\\mathbf{0}^T &  1 \end{matrix}\right]$$ 我想要画出相机的运动轨迹，即把相机中心坐标点连接起来，请问：在这两个矩阵中，哪个矩阵的平移向量是相机中心坐标？ 答案是$T_{WR}$的平移向量是相机的中心坐标，即$-R^Tt$很容易推导，我们先理解一下题意，所谓的相机中心坐标其实就是机器人坐标系的原点，即$p_{R}&#x3D;0$，我们只需要求$p_{W}$就可以了，那么根据公式：$$p_{W}&#x3D;T_{WR}p_{R}$$带入计算：$$T_{WR}p_{R}=\left[\begin{matrix}  R^T & -R^Tt\\\mathbf{0}^T &...</div></div></div></a><a class="pagination-related" href="/2026/01/28/Visual_SLAM/05_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E4%B8%80/" title="视觉SLAM学习笔记：一"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-28</div><div class="info-item-2">视觉SLAM学习笔记：一</div></div><div class="info-2"><div class="info-item-1">第二章下面这个网址有电子版的图书（带我的批注）https://github.com/pumpkin-db/pumpkin-db.github.io/tree/main/%E8%A7%86%E8%A7%89SLAMPDF(%E5%B8%A6%E6%89%B9%E6%B3%A8) 数学建模抽象开始先给了总结SLAM过程的两个抽象方程，上面的是运动方程，下面的是观测方程，这样算是把SLAM问题变成了状态估计问题。当然这里没怎么看懂，但一步步顺过来还是可以的。具体的以后再说 g++ cmake IDE 编译代码g++ cmake然后就进行到实战环节，在&#x2F;home下创建了slambook2文件夹，再创建ch2文件夹，然后书写第一个cpp程序，然后使用g++进行编译，修改完权限后就可以运行编译文件，不过据笔者建议，今后为了能够顺利的方便的编译大量代码，要使用cmake命令，一般使用流程是：  建立CMakeLists.txt文件，加入内容，目的是告诉cmake要做什么 为便于管理，在本目录下建立build文件夹，使得cmake编译的文件都放到这里，和源代码分开，使用mkdir bu...</div></div></div></a><a class="pagination-related" href="/2026/02/04/Visual_SLAM/07_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E4%B8%89/" title="视觉SLAM学习笔记：三"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-04</div><div class="info-item-2">视觉SLAM学习笔记：三</div></div><div class="info-2"><div class="info-item-1">第四章李群和李代数群群（Group）是一种集合加上一种运算的代数结构若集合记作$A$,运算记作$\cdot$,那么群就可以记作$G=(A,\cdot)$这个运算需要满足以下条件：   封闭性： $\forall a_{1},a_{2}\in A, a_{1} \cdot a_{2}\in A$    结合率： $\forall a_{1},a_{2},a_{3}\in A,(a_{1}\cdot a_{2})\cdot a_{3}=a_{1}\cdot (a_{2}\cdot a_{3})$    幺元： $\exists a_{0} \in A,$   $s.t.$    $a\cdot a^{-1}=a_{0}$    逆： $\forall a\in A,\exists a^{-1} \in A$,  $s.t.$   $a\cdot a^{-1}=a_{0}$    可以记为：“凤姐咬你” $SO(3)与SE(3)$三维旋转矩阵构成特殊正交群(Special Orthogonal Group)$SO(3)$变换矩阵构成特殊欧氏群(Special Euclidean Gro...</div></div></div></a><a class="pagination-related" href="/2026/01/26/Linux/01_Linux%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E4%B8%80/" title="Linux学习笔记：一"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-26</div><div class="info-item-2">Linux学习笔记：一</div></div><div class="info-2"><div class="info-item-1">摘要：本笔记主要写了Linux的基础常用的命令 一、ls(list)命令 ls [-a -l -h] [路径]类似windows的dir同样这里也有dir vdir两个命令，使用方式就是dir/vdir 路径vdir就相当于ls -l 路径 ls -l 缩写为 ll比ls的功能少一点 1. ls命令的参数的作用可以指定要查看的文件夹（目录）的内容，如果不给定参数，就查看当前工作目录的内容。2. ls命令的选项：  -a 选项：可以展示出隐藏的内容。 以 .开头的文件或文件夹默认被隐藏，需要 -a才能显示出来。   -l 选项：以列表的形式展示内容，并展示更多细节。 -h 选项：需要和 -l选项搭配使用，以更加人性化的方式显示文件的大小单位。3. 命令的选项组合使用命令的选项是可以组合使用的，比如：ls -lah，等同于 ls -a -l -h。  二、目录切换：cd(change directory)与pwd(print work directory)cd [路径]pwd 打印当前路径 三、特殊路径符：.与..与~.：表示当前目录，cd ./Desktop 效果等同于 cd De...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">pumpkin-db</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">10</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pumpkin-db/pumpkin-db.github.io"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog. I will try my best to do this.</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%83%E7%AB%A0%E3%80%81%E7%AC%AC%E5%85%AB%E7%AB%A0"><span class="toc-number">1.</span> <span class="toc-text">第七章、第八章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E8%A7%89%E9%87%8C%E7%A8%8B%E8%AE%A1-VO-Visual-Odometry"><span class="toc-number">1.1.</span> <span class="toc-text">视觉里程计(VO-Visual Odometry)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E7%82%B9%E6%B3%95"><span class="toc-number">1.1.1.</span> <span class="toc-text">特征点法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ORB-Oriented-FAST-and-Rotated-BRIEF-%E7%89%B9%E5%BE%81"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">ORB(Oriented FAST and Rotated BRIEF)特征</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E5%8C%B9%E9%85%8D"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">特征匹配</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2D-2D%EF%BC%9A%E5%AF%B9%E6%9E%81%E5%87%A0%E4%BD%95"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">2D-2D：对极几何</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.1.1.3.1.</span> <span class="toc-text">基本模型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%AC%E8%B4%A8%E7%9F%A9%E9%98%B5"><span class="toc-number">1.1.1.3.2.</span> <span class="toc-text">本质矩阵</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%95%E5%BA%94%E7%9F%A9%E9%98%B5"><span class="toc-number">1.1.1.3.3.</span> <span class="toc-text">单应矩阵</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%B9%E6%9E%81%E5%87%A0%E4%BD%95%E7%9A%84%E4%B8%89%E7%A7%8D%E8%AE%A8%E8%AE%BA"><span class="toc-number">1.1.1.3.4.</span> <span class="toc-text">对极几何的三种讨论</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%B0%BA%E5%BA%A6%E4%B8%8D%E7%A1%AE%E5%AE%9A%E6%80%A7%EF%BC%9A"><span class="toc-number">1.1.1.3.4.1.</span> <span class="toc-text">尺度不确定性：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E7%BA%AF%E6%97%8B%E8%BD%AC%E9%97%AE%E9%A2%98"><span class="toc-number">1.1.1.3.4.2.</span> <span class="toc-text">初始化的纯旋转问题</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%A4%9A%E4%BD%99%E5%85%AB%E5%AF%B9%E7%82%B9%E7%9A%84%E6%83%85%E5%86%B5"><span class="toc-number">1.1.1.3.4.3.</span> <span class="toc-text">多余八对点的情况</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%89%E8%A7%92%E6%B5%8B%E9%87%8F"><span class="toc-number">1.1.1.3.5.</span> <span class="toc-text">三角测量</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3D-2D%EF%BC%9APnP-Perspective-n-Point-%E9%80%8F%E8%A7%86n%E7%82%B9"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">3D-2D：PnP(Perspective-n-Point 透视n点)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2-DLT"><span class="toc-number">1.1.1.4.1.</span> <span class="toc-text">直接线性变换(DLT)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#P3P"><span class="toc-number">1.1.1.4.2.</span> <span class="toc-text">P3P</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E5%8C%96%E9%87%8D%E6%8A%95%E5%BD%B1%E8%AF%AF%E5%B7%AE"><span class="toc-number">1.1.1.4.3.</span> <span class="toc-text">最小化重投影误差</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3D-3D%EF%BC%9AICP-Iterative-Cloest-Point-%E8%BF%AD%E4%BB%A3%E6%9C%80%E8%BF%91%E7%82%B9"><span class="toc-number">1.1.1.5.</span> <span class="toc-text">3D-3D：ICP(Iterative Cloest Point 迭代最近点)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#SVD%E6%96%B9%E6%B3%95"><span class="toc-number">1.1.1.5.1.</span> <span class="toc-text">SVD方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95"><span class="toc-number">1.1.1.5.2.</span> <span class="toc-text">非线性优化方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E6%B3%95"><span class="toc-number">1.1.2.</span> <span class="toc-text">直接法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2D%E5%85%89%E6%B5%81"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">2D光流</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Lucas-Kanade%E5%85%89%E6%B5%81"><span class="toc-number">1.1.2.1.1.</span> <span class="toc-text">Lucas-Kanade光流</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E6%B3%95-1"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">直接法</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/13/Visual_SLAM/10_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E5%85%AD/" title="视觉SLAM学习笔记：六">视觉SLAM学习笔记：六</a><time datetime="2026-02-12T16:00:00.000Z" title="Created 2026-02-13 00:00:00">2026-02-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/07/Visual_SLAM/09_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E4%BA%94/" title="视觉SLAM学习笔记：五">视觉SLAM学习笔记：五</a><time datetime="2026-02-06T16:00:00.000Z" title="Created 2026-02-07 00:00:00">2026-02-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/06/Visual_SLAM/08_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E5%9B%9B/" title="视觉SLAM学习笔记：四">视觉SLAM学习笔记：四</a><time datetime="2026-02-05T16:00:00.000Z" title="Created 2026-02-06 00:00:00">2026-02-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/04/Visual_SLAM/07_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E4%B8%89/" title="视觉SLAM学习笔记：三">视觉SLAM学习笔记：三</a><time datetime="2026-02-03T16:00:00.000Z" title="Created 2026-02-04 00:00:00">2026-02-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/02/Visual_SLAM/06_%E8%A7%86%E8%A7%89SLAM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E4%BA%8C/" title="视觉SLAM学习笔记：二">视觉SLAM学习笔记：二</a><time datetime="2026-02-01T16:00:00.000Z" title="Created 2026-02-02 00:00:00">2026-02-02</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By pumpkin-db</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        loader: {
          load: [
            // Four font extension packages (optional)
            //- '[tex]/bbm',
            //- '[tex]/bboldx',
            //- '[tex]/dsfont',
            '[tex]/mhchem'
          ],
          paths: {
            'mathjax-newcm': '[mathjax]/../@mathjax/mathjax-newcm-font',

            //- // Four font extension packages (optional)
            //- 'mathjax-bbm-extension': '[mathjax]/../@mathjax/mathjax-bbm-font-extension',
            //- 'mathjax-bboldx-extension': '[mathjax]/../@mathjax/mathjax-bboldx-font-extension',
            //- 'mathjax-dsfont-extension': '[mathjax]/../@mathjax/mathjax-dsfont-font-extension',
            'mathjax-mhchem-extension': '[mathjax]/../@mathjax/mathjax-mhchem-font-extension'
          }
        },
        output: {
          font: 'mathjax-newcm',
        },
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
          packages: {
            '[+]': [
              'mhchem'
            ]
          }
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          menuOptions: {
            settings: {
              enrich: false  // Turn off Braille and voice narration text automatic generation
            }
          },
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax@4.0.0/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>